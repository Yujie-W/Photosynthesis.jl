<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · Photosynthesis</title><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script><link href="assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href><img src="assets/logo.svg" alt="Photosynthesis logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href>Photosynthesis</a></span></div><form class="docs-search" action="search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a><ul class="internal"><li><a class="tocitem" href="#Install"><span>Install</span></a></li><li><a class="tocitem" href="#About"><span>About</span></a></li><li><a class="tocitem" href="#Model-Selection"><span>Model Selection</span></a></li><li><a class="tocitem" href="#Photosynthesis-Model-Procedure"><span>Photosynthesis Model Procedure</span></a></li></ul></li><li><a class="tocitem" href="API/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/Yujie-W/Photosynthesis.jl/blob/main/docs/src/index.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Photosynthesis.jl"><a class="docs-heading-anchor" href="#Photosynthesis.jl">Photosynthesis.jl</a><a id="Photosynthesis.jl-1"></a><a class="docs-heading-anchor-permalink" href="#Photosynthesis.jl" title="Permalink"></a></h1><h2 id="Install"><a class="docs-heading-anchor" href="#Install">Install</a><a id="Install-1"></a><a class="docs-heading-anchor-permalink" href="#Install" title="Permalink"></a></h2><pre><code class="language-julia hljs">using Pkg;
Pkg.add(&quot;Photosynthesis&quot;);</code></pre><h2 id="About"><a class="docs-heading-anchor" href="#About">About</a><a id="About-1"></a><a class="docs-heading-anchor-permalink" href="#About" title="Permalink"></a></h2><p>Photosynthesis models for C3 and C4 photosynthesis. Photosynthesis.jl supports three photosynthesis models and two fluorescence models. The photosynthesis models are</p><ul><li>C3VJP model based on classic C3 model, which is known as FvCB model (Farquhar et al. 1980)</li><li>C4VJP model based on classic C4 model, which is known as Collaz model (Collaz et al. 1992)</li><li>C3Cytochrome model based on a new C3 model developed by Johnson and Berry (2021)</li></ul><p>We, however, made some modifications by adding a product limited photosynthetic rate to the C3 models, and a Rubisco limited photosynthetic rate to the C4 model.</p><p>Besides the tranditional photosynthesis model, we also included functions to compute fluorescence related parameters, such as fluorescence quantum yield and non-photochemical quenching. he two implemented fluorescence models are</p><ul><li>Van der Tol et al. (2013) fluorescence model to use with C3VJP and C4VJP models</li><li>Johnson and Berry (2021) fluorescence model to use with C3Cytochrome model</li></ul><p>We aim to make Photosynthesis.jl a standalone package rather than just part of the CliMA Land model. Thus, in the documentations below, we will present examples of how to use Photosynthesis.jl at the leaf level. Same logic applies to canopy scale simulations.</p><h2 id="Model-Selection"><a class="docs-heading-anchor" href="#Model-Selection">Model Selection</a><a id="Model-Selection-1"></a><a class="docs-heading-anchor-permalink" href="#Model-Selection" title="Permalink"></a></h2><p>Starting from v0.3, photosynthesis and fluorescence model selection is done by setting up the fields of a leaf. There are three types of leaf in Photosynthesis (all the structures are defined in ClimaCache.jl and shared among all CliMA Land submodules), and they are</p><ul><li><code>Leaf</code> for a single leaf to use in leaf level research</li><li><code>Leaves1D</code> for a vector of leaves to use in big leaf models</li><li><code>Leaves2D</code> for a matrix of sunlit fractions and a shaded fraction to use along with canopy with leaf angular distribution</li></ul><p>For all of the three leaf structs, there are two fields named</p><ul><li><code>PSM</code> for photosynthesis model</li><li><code>PRC</code> for photosynthesis reaction center</li></ul><p>A <code>C3VJPModel</code> type <code>PSM</code> along with a <code>VJPReactionCenter</code> type <code>PRC</code> defines the C3VJP model; a <code>C4VJPModel</code> type <code>PSM</code> along with a <code>VJPReactionCenter</code> type <code>PRC</code> defines the C4VJP model; and a <code>C3CytochromeModel</code> type <code>PSM</code> along with a <code>CytochromeReactionCenter</code> type <code>PRC</code> defines the C3Cytochrome model. For instance, <code>leaf_c3</code>, <code>leaf_c4</code>, and <code>leaf_cy</code> each defines a model to use the three predefined photosynthesis models:</p><pre><code class="language-julia hljs">using ClimaCache;
FT = Float64;

leaf_c3 = ClimaCache.Leaf{FT}();
leaf_c4 = ClimaCache.Leaf{FT}(PSM = ClimaCache.C4VJPModel{FT}());
leaf_cy = ClimaCache.Leaf{FT}(PSM = ClimaCache.C3CytochromeModel{FT}(), PRC = ClimaCache.CytochromeReactionCenter{FT}());

# users can define the same fields for Leaves1D and Leaves2D to custoimize photosynthesis model
leaf_d3 = ClimaCache.Leaves1D{FT}();
leaf_d4 = ClimaCache.Leaves1D{FT}(PSM = ClimaCache.C4VJPModel{FT}());
leaf_dy = ClimaCache.Leaves1D{FT}(PSM = ClimaCache.C3CytochromeModel{FT}(), PRC = ClimaCache.CytochromeReactionCenter{FT}());
leaf_e3 = ClimaCache.Leaves2D{FT}();
leaf_e4 = ClimaCache.Leaves2D{FT}(PSM = ClimaCache.C4VJPModel{FT}());
leaf_ey = ClimaCache.Leaves2D{FT}(PSM = ClimaCache.C3CytochromeModel{FT}(), PRC = ClimaCache.CytochromeReactionCenter{FT}());</code></pre><h2 id="Photosynthesis-Model-Procedure"><a class="docs-heading-anchor" href="#Photosynthesis-Model-Procedure">Photosynthesis Model Procedure</a><a id="Photosynthesis-Model-Procedure-1"></a><a class="docs-heading-anchor-permalink" href="#Photosynthesis-Model-Procedure" title="Permalink"></a></h2><p>For all three photosynthesis+fluorescence combo models, photosynthetic rates are computed using the following procedure:</p><ul><li>Update temperature dependent variables using <code>photosystem_temperature_dependence!</code></li><li>Calculate electron transport rate using <code>photosystem_electron_transport!</code></li><li>Calculate RubisCO limited rate using <code>rubisco_limited_rate!</code></li><li>Calculate light limited rate using <code>light_limited_rate!</code></li><li>Calculate product limited rate using <code>product_limited_rate!</code></li><li>Calculate gross and net rates using <code>colimit_photosynthesis!</code></li><li>Update fluorescence related variables using <code>photosystem_coefficients!</code></li></ul><p>Yet, for convenience, all the listed steps are combined in one function <code>leaf_photosynthesis!</code> (see page API for all supported methods). At leaf level, one can simply call the function, for example</p><pre><code class="language-julia hljs">using Photosynthesis

air    = ClimaCache.AirLayer{FT}();
g_mode = ClimaCache.GCO₂Mode();
p_mode = ClimaCache.PCO₂Mode();
Photosynthesis.leaf_photosynthesis!(leaf_c3, air, g_mode);
Photosynthesis.leaf_photosynthesis!(leaf_cy, air, p_mode);</code></pre><p>Note here that (1) we need parameters from surrounding air to compute photosynthetic rates, such as oxygen concentration, (2) <code>GCO₂Mode</code> mode is used when leaf total diffusive conductance for CO₂ is known, and <code>PCO₂Mode</code> is used when leaf internal CO₂ partial pressure is known, and (3) leaf and air conditions must be synced before calling the <code>leaf_photosynthesis!</code> function. For example, to construct an A-Ci curve, one will need to change the field <code>_p_CO₂_i</code> to proceed:</p><pre><code class="language-julia hljs">leaf_c3.t = 300;
leaf_c3.ppar = 1000;
for _p in 5:5:100
    leaf_c3._p_CO₂_i = _p;
    Photosynthesis.leaf_photosynthesis!(leaf_c3, air, p_mode);
    @info &quot;Photosynthetic rate at&quot; leaf_c3._p_CO₂_i leaf_c3.a_net;
end</code></pre><p>In the example above, we first defined leaf temperature is 300 <code>K</code> (note that we use Kelvin here, not Celcius), then prescribed a PPAR of 1000 <code>μmol m⁻² s⁻¹</code>. PPAR is the photosynthetically active radiation (PAR) that goes to photosystems; PPAR is different from APAR (PAR absorbed by leaf, some APAR does not go to photosystems). Ssee our <a href=" https:/doi.org/10.5194/bg-2022-172">technical note</a> for the difference between PAR, APAR, and PPAR. Similarly, we can try out how Anet responds to leaf temperature and PPAR by modifying the example above.</p></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="API/">API »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Thursday 27 October 2022 17:25">Thursday 27 October 2022</span>. Using Julia version 1.8.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
